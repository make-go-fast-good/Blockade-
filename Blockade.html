<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <title>Blockade Check</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width">
    <meta name="viewport" content="initial-scale=1.0">
    <link rel="stylesheet" href="./css/w3.css">
    <link rel="stylesheet" href="./css/jquery-ui.css">
    <script src="./js/papaparse.js"></script>
    <!--papaParse api-->
    <script src="./js/exceljs.js"></script>
    <!--exceljs api-->
    <script src="./js/FileSaver.min.js"></script>
    <!--fileSaver api-->
    <script src="./js/moment.js"></script>
    <!--moment api-->
    <script src="./js/jquery-1.12.4.js"></script>
    <!--jquery api-->
    <script src="./js/jquery-ui.js"></script>
    <!--jquery-ui api-->
</head>

<style>
    ul {
        list-style-type: none;
        text-align: center;
        display: inline-block;
        padding: 0;
        margin: 0;
    }
    #left_side {
        float: left;
    }

    #right_side {
        float: left;
    }

    #aisle_center {
        border: .15em solid black;
        background-color: #B2BCC4;
        width: 6vw;
        min-height: 14.25vw;
        margin: .25em;
        text-align: center;
        float: left;
        text-orientation: upright;
        padding: 1.15vw;
    }

    .location {
        background-color: #93a1a1;
        border: medium solid black;
        margin: 0.1em;
        padding: 1vw;
        height: auto;
    }

    .shelf {
        background-color: #B2BCC4;
        margin: .1em .9em .1em .9em;
        border: .15em solid black;
        padding: .5vw;
        height: auto;
        min-height: 2.8vw;
    }

    .navette_shut {
        margin: .4vh .4vw .4vh .4vw;
        background-color: #7A8B99;
        border-style: solid;
        border-width: thin;
        border-color: black;
        padding: .5vh .5vw .5vh .5vw;
    }

    .rack {
        margin: 10px;
        background-color: #7A8B99;
        border-style: solid;
        border-width: medium;
        border-color: black;
        padding: 1.25vw;
    }

    .invisible_td {
        display: block;
        margin: .1vh .01vw .1vh .01vw;
        padding: .04vh 0vw .04vh 0vw;
        opacity: 0;
    }

    .aisle {
        display: block;
        margin: .1vh 2vw .1vh 2vw;
        padding: .04vh 0vw .04vh 0vw;
        font: "Segoe UI", Arial, Helvetica, sans-serif;
        font-size: calc(1vw + 6 * ((100vw - 680px) / 680));
    }

    .arrow {
        display: block;
        margin: .1vh 3vw .1vh 3vw;
        padding: .1vh 0vw .1vh 0vw;
        font: "Segoe UI", Arial, Helvetica, sans-serif;
        font-size: calc(2vw + 6 * ((100vw - 680px) / 680));
    }

    #wrapper {
        float: right;
    }

    .container {
        margin-left: auto;
        margin-right: auto;
    }

    body {
        background-color: #eaeaea;
        height: 100%;
        margin: .5em;
        font-size: calc(((.65vw + 6 * ((100vw - 680px)) / 680) + (.55vh + 6 * ((100vh - 680px) / 680))) / 2);
        font: "Segoe UI", Arial, Helvetica, sans-serif;
    }

    p,
    h1,
    h2,
    h3,
    h4 {
        color: black;
    }

    .button {
        cursor: pointer;
        background-color: lightgray;
        border-radius: 1vw;
        margin: .5vw;
        min-width: calc(6vw + 6 * ((100vw - 680px) / 680));
        padding: .5vw;
        text-align: center;
    }

    .smbutton {
        cursor: pointer;
        background-color: yellow;
        border-radius: 1vw;
        margin: .5vw;
        min-width: calc(6vw + 6 * ((100vw - 680px) / 680));
        font-size: calc(.75vw + 6 * ((100vw - 680px) / 680));
        padding: .8vw;
    }

    .file {
        cursor: pointer;
        background-color: lightgray;
        border-radius: 1vw;
        margin: 1vw;
        font-size: calc(.5vw + 6 * ((100vw - 680px) / 680));
        padding: .5vw;
        text-align: center
    }

    .ssi-header-logo {
        float: right;
        height: 1.5vw;
        margin: .5vw;
        width: auto;
    }

    h1 {
        text-align: left;
        font-family: arial;
        font-size: 2vw;
        padding: .5vw;
        margin-top: 0px;
        margin-bottom: .15vw;
        background-color: yellow;
    }

    h2 {
        font-family: arial;
        font-size: calc(.8vw + 6 * ((100vw - 320px) / 680));
        margin: 15px;
        font-weight: normal
    }

    h3 {
        text-align: left;
        font-family: arial;
        font-size: calc(.65vw + 6 * ((100vw - 320px) / 680));
        padding: 12px;
        margin-top: 0px;
        margin-bottom: 5px;
        background-color: yellow;
    }

    h4 {
        font-family: arial;
        font-size: calc(.5vw + 6 * ((100vw - 320px) / 680));
        margin: 5px;
        font-weight: normal
    }
</style>
<script>
    var xValues = [0, 2880, 5760, 8640, 11520, 14400, 17280, 20160, 23040, 25920, 28800, 31680, 34560, 37440, 40320,
        43200, 46080, 48960, 51840, 54720, 57600, 60480, 63360, 66240, 69120, 72000, 74880, 77760, 80640, 83520,
        86400, 89280, 92160, 95040, 97920, 100800, 103680, 106560, 109440, 112320, 115200
    ];
    var navettes = [1111, 1112, 1113, 1114,
        1211, 1212, 1213, 1214,
        2111, 2112, 2113, 2114,
        2211, 2212, 2213, 2214,
        3111, 3112, 3113, 3114,
        3211, 3212, 3213, 3214,
        4111, 4112, 4113, 4114,
        4211, 4212, 4213, 4214,
        5111, 5112, 5113, 5114,
        5211, 5212, 5213, 5214,
        6111, 6112, 6113, 6114,
        6211, 6212, 6213, 6214
    ];
    var rack = [11, 12, 13, 14, 15, 16, 17, 18,
        21, 22, 23, 24, 25, 26, 27, 28
    ];

    function parseData() {
        document.getElementById("resultText").value = "Success!";
        var elements_left = document.getElementById("left_side").querySelectorAll("div");
        var elements_right = document.getElementById("right_side").querySelectorAll("div");

        for (var i = 0; i < elements_left.length; i++) {
            elements_left[i].style.backgroundColor = "#7A8B99";
        }
        for (var i = 0; i < elements_right.length; i++) {
            elements_right[i].style.backgroundColor = "#7A8B99";
        }
        var inputText = document.getElementById("inputText").value;
        // Empty check
        if (inputText == "" || inputText == null) {
            document.getElementById("resultText").value = "Empty!";
        }
        // Length check
        if (inputText.length < 14 || inputText.length > 20) {
            document.getElementById("resultText").value = "Invalid length!";
        } else {
            // NRA check
            if (inputText[0] != "N" || inputText[1] != "R" || inputText[2] != "A") {
                document.getElementById("resultText").value = "Not a rack location!";
            }
            var aValue = inputText.substring(inputText.lastIndexOf("A") + 1, inputText.lastIndexOf("X"));
            if ((aValue.length != 4) || (isNaN(parseInt(aValue)))) {
                document.getElementById("resultText").value = "Invalid aisle value!";
            } else {
                var aValueArr = aValue.split("");
                aValueArr[2] = "1";
                aValue = aValueArr.join("");
                //Highlight the selected Navette
                for (var i = 0; i < navettes.length; i++) {
                    if (aValue == navettes[i]) {
                        document.getElementById(aValue).style.backgroundColor = "yellow";
                    } else {
                        document.getElementById(navettes[i]).style.backgroundColor = "#7A8B99";
                    }
                }
                var xValue = inputText.substring(inputText.lastIndexOf("X") + 1, inputText.lastIndexOf("Y"));
                document.getElementById("xtable").innerHTML = xValue;
                if (isNaN(parseInt(xValue))) {
                    document.getElementById("resultText").value = "Invalid X: not a number!";
                } else {
                    if (xValues.indexOf(parseInt(xValue)) == -1)
                        document.getElementById("resultText").value = "Invalid X value!";
                    else {
                        var fValue = 0;
                        while (xValue > -1) {
                            xValue -= 2880;
                            fValue++;
                        }
                        // correction due field numbering starting with 2 not 1
                        fValue++;
                        document.getElementById("ftable").innerHTML = fValue;
                    }
                }
                var yValue = inputText.substring(inputText.lastIndexOf("Y") + 1, inputText.lastIndexOf("Z"));
                var zValue = inputText.substring(inputText.lastIndexOf("Z") + 1);
                switch (yValue) {
                    case "01":
                    case "02":
                    case "03":
                    case "04":
                    case "05":
                        document.getElementById("ytable").innerHTML = yValue;
                        if (zValue[0] == "1") {
                            document.getElementById("l" + yValue).style.backgroundColor = "yellow";
                        } else if (zValue[0] == "2") {
                            document.getElementById("r" + yValue).style.backgroundColor = "yellow";
                        }
                        break;
                    default:
                        document.getElementById("resultText").value = "Invalid Y value!";
                }
                if (zValue.length == 1) {
                    if (zValue == "1") {
                        document.getElementById("x11").style.backgroundColor = "yellow";
                    } else if (zValue == "2") {
                        document.getElementById("x21").style.backgroundColor = "yellow";
                    } else {
                        document.getElementById("resultText").value = "Invalid Z value!";
                    }
                } else {
                    for (var i = 0; i < rack.length; i++) {
                        if (zValue != rack[i]) {
                            document.getElementById("x" + rack[i]).style.backgroundColor = "#7A8B99";
                            document.getElementById("ztable").innerHTML = "Invalid Z value!";
                        } else {};
                    }
                    switch (zValue) {
                        case "11":
                        case "12":
                        case "13":
                        case "14":
                        case "15":
                        case "16":
                        case "17":
                        case "18":
                        case "21":
                        case "22":
                        case "23":
                        case "24":
                        case "25":
                        case "26":
                        case "27":
                        case "28":
                            document.getElementById("x" + zValue).style.backgroundColor = "yellow";
                            document.getElementById("ztable").innerHTML = zValue;
                            break;
                        default:
                            document.getElementById("resultText").value = "Invalid Z value!";
                    }
                }
            }
        }
    }
</script>
<script>
    $(function () {
        var wk = $("#startDate").datepicker({
            showOtherMonths: true,
            selectOtherMonths: true,
            onSelect: function (dateText, inst) {
                //When we select the start date for custom export populate the filename field automatically with the week number.
                var startDate = new Date(dateText);
                var selectedYear = startDate.getFullYear();
                $("#wbName").val(selectedYear + " Week " + $.datepicker.iso8601Week(startDate));
            }
        });
    });
    $(function () {
        $("#endDate").datepicker({
            showOtherMonths: true,
            selectOtherMonths: true
        });
    });

    async function customExport() {
        let start = document.querySelector('#startDate');
        let end = document.querySelector('#endDate');
        let URL = [];
        const range = await getcustomExport(start.value, end.value);
        range.forEach(item => URL.push(getURL(item.getDay(), item)));
        loopURLs(URL); //Send each download request to the server
    }
    //create date object array. 
    function getcustomExport(_sdate, _edate) {
        let date = new Date(_sdate);
        let enddate = new Date(_edate);
        let days = [];

        //this creates an array of date objects for all the days in a given month. 
        while (date.getTime() <= enddate.getTime()) {
            days.push(new Date(date));
            date.setDate(date.getDate() + 1);
        }
        return days;
    }
</script>

<!--main functions -->
<script>
    //Set timeout so visu server doesn't reject everything. 
    function sleep(ms) {
        return new Promise(resolve => setTimeout(resolve, ms))
    }

    //create date object array. 
    function getDaysInMonth(_month, _year) {
        let date = new Date(_year, _month, 1);
        let days = [];

        //this creates an array of date objects for all the days in a given month. 
        while (date.getMonth() === _month) {
            days.push(new Date(date));
            date.setDate(date.getDate() + 1);
        }
        return days;
    }

    function getDays(_inputMon) {
        let URL = [];
        //just assume we only care about this year.
        let inputYear = new Date().getFullYear();
        //urlDays is an array of Date objects
        let urlDays = getDaysInMonth(_inputMon, inputYear);

        /*This iterates through each item in the array urlDays(an array of Date
        objects), gets the integer
        value for day of the week. (.getDay = 0-6), calls the function getURL with that value,
        concatenates everything and then pushes the final URL into an array of urls
        named "URL"*/

        urlDays.forEach(item => URL.push(getURL(item.getDay(), item)));
        loopURLs(URL); //Send each download request to the server
    }


    async function parsefiles() {
        //get filelist of files selected to parse from the html input.
        const rawFiles = document.getElementById("file").files;
        // create the book. 
        const book = new ExcelJS.Workbook();
        //for loop the iteration protocol way, loop through all the files in the file list. 
        for (const item of rawFiles) {
            await Papa.parse(item, {
                complete: async function (results) {
                    data = results.data;
                    //slice the array to cut off the first and last elements, we don't need them.
                    data = data.slice(2, data.length - 1);
                    const ws = book.addWorksheet()
                    ws.views = [{
                        state: 'frozen',
                        ySplit: 1,
                        activeCell: 'A1'
                    }];
                    ws.getRow(1).font = {
                        bold: true
                    };
                    ws.columns = [{
                        header: 'StartTime',
                        key: '_startTime',
                        width: 20
                    }, {
                        header: 'EndTime',
                        key: '_endTime',
                        width: 20
                    }, {
                        header: 'Text',
                        key: '_text',
                        width: 70
                    }, {
                        header: 'Duration',
                        key: '_duration',
                        width: 12
                    }];
                    //Initialize new array that will be used to remove duplicate time stamps and concat fault strings. 
                    //for loop ES6 way. 
                    var day = [];
                    data.forEach((fault, index) => {
                        day = isDuplicate(day, fault)
                    })

                    day.forEach((fault, index) => {
                        //enable multiline text in cells used for faults.
                        if (index === day.length - 1) {
                            //last line hack to get textwrap to work correctly.
                            ws.getCell('C' + (index + 1).toString()).alignment = {
                                wrapText: true
                            };
                            ws.addRow({
                                _startTime: fault[2],
                                _endTime: fault[3],
                                _text: fault[6] + " " + fault[7].trim(),
                                _duration: fault[4]
                            })
                            ws.getCell('C' + (index + 2).toString()).alignment = {
                                wrapText: true
                            };
                            ws.addRow({
                                _startTime: "",
                                _endTime: "",
                                _text: "",
                                _duration: ""
                            })
                        } else {
                            ws.getCell('C' + (index + 1).toString()).alignment = {
                                wrapText: true
                            };
                            ws.addRow({
                                _startTime: fault[2],
                                _endTime: fault[3],
                                _text: fault[6] + " " + fault[7].trim(),
                                _duration: fault[4]
                            })
                        }
                    })

                    // We're gonna give the sheets meaningful names. 
                    for (let i = 0; i < book.worksheets.length; ++i) {
                        for (let i = 0; i < book.worksheets.length; ++i) {
                            if (book.worksheets[i].getCell('B2').value != null) {
                                var d = new Date(book.worksheets[i].getCell('B2').value);
                                break;
                            }
                        }
                        // start at first date found an iterate from there.
                        const start = d.getDate();
                        d.setDate(i + start);

                        let day = d.toLocaleString('default', {
                            weekday: 'short'
                        });
                        // 08-01 instead of 2019-08-01 
                        d = d.toJSON().slice(5, 10);

                        // Mo instead of Mon to make the name fit in the tabs.
                        day = day.slice(0, 2);

                        // Mo 08-01, Tu 08-02, etc....
                        book.worksheets[i].name = day + " " + d;

                    }

                }
            })
        }
        //console.log(book);
        //Is it really a hack if it works? 
        await sleep(1000);
        //Write buffer and use the filesaver API to create a xlsx file. 
        writeBook(book);
    }

    async function writeBook(book) {
        // use fileSaver API to save file since excelJS doesn't support in browser saving.
        for (let i = 0; i < book.worksheets.length; ++i) {
            if (book.worksheets[i].getCell('B2').value != null) {
                var d = new Date(book.worksheets[i].getCell('B2').value);
                break;
            }
        }
        let m = d.toLocaleString('default', {
            month: 'long'
        });
        d = d.toJSON().slice(0, 5);

        book.xlsx.writeBuffer()
            .then(function (buffer) {
                //Check to see if there is a filename already present. If not generate one. 
                if ($("#wbName").val()) {
                    var filename = $("#wbName").val() + '.xlsx';
                } else {
                    var filename = d + m + ' Navette KPI.xlsx'
                }
                var blob = new Blob([buffer], {
                    type: "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
                })
                saveAs(blob, filename);
            });
    }

    function isDuplicate(day, fault) {
        var found = false;

        if (day.length === 0) {
            day.push(fault);
        }

        if (day.length > 0) {

            for (let i = 0; i < day.length; i++) {

                if (day[i][6] === fault[6] &&
                    (day[i][2] <= fault[2] && (day[i][3] >= fault[2]))
                ) {

                    // Found it
                    if ((day[i][2] === fault[2] && day[i][3] <= fault[3]) ||
                        (day[i][2] <= fault[2] && day[i][3] > fault[2]) && (day[i][3] <= fault[3])
                    ) {
                        /*If start time of new fault starts while another fault is present and ends
                          after the present fault time, add the fault to the group and replace the end time.*/
                        day[i][3] = fault[3];
                        //adjust the duration of the fault, use momentjs api to make things easier.
                        var d1 = new Date(day[i][2]);
                        var d2 = new Date(fault[3]);
                        var ms = moment(d2, "DD/MM/YYYY HH:mm:ss").diff(moment(d1, "DD/MM/YYYY HH:mm:ss"));
                        var d = moment.duration(ms);
                        var s = Math.floor(d.asHours()) + moment.utc(ms).format(":mm:ss");
                        day[i][4] = s;
                        //check for the string to exist in the existing fault text, only add if unique.
                        if (day[i][7].indexOf(fault[7]) === -1) {
                            day[i][7] = day[i][7].concat(',\r\n' + fault[6] + " " + fault[7].trim());
                        };
                    } else if (day[i][2] <= fault[2] && (day[i][3] >= (fault[3] || fault[2]))) {
                        //check for the string to exist in the existing fault text, only add if unique.
                        if (day[i][7].indexOf(fault[7]) === -1) {
                            day[i][7] = day[i][7].concat(',\r\n' + fault[6] + " " + fault[7].trim());
                        };
                    } else if (found === false && day[i][3] < fault[2] && day[i][3] < fault[3]) {
                        //push the new fault entry reset i and start over to verify.
                        day.push(fault);
                        i = 0;
                        found = true;
                    } else {
                        //nothing to do here.
                    }
                    found = true;
                }
                //First fault add row. ,check the indexes in day for existing timestamps,then push new fault if unique 
                if (found === false && i === day.length - 1) {
                    day.push(fault);
                }
            }
        }
        return day;
    }
</script>

<body>
    <div class="w3-panel">
        <div class="w3-container">
            <h1>Blockade Check<img
                    src=" data:image/png;base64,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"
                    alt="Cannot load image" class="ssi-header-logo"></h1>
        </div>
    </div>
    <div class="w3-col s5 ">
        <div class="w3-padding w3-display-right w3-panel w3-card w3-margin">
            <h4 class="w3-center">Navette Location</h4>
            <table class="w3-container container">
                <tr>
                    <td id="6214" rowspan=2 class="navette_shut"><a>6<br />2<br />1<br />4</a></td>
                    <td id="" class="invisible_td"><a>0<br /></a></td>
                    <td id="6114" rowspan=2 class="navette_shut"><a>6<br />1<br />1<br />4</a></td>
                    <td id="5214" rowspan=2 class="navette_shut"><a>5<br />2<br />1<br />4</a></td>
                    <td id="" class="invisible_td"><a>0<br /></a></td>
                    <td id="5114" rowspan=2 class="navette_shut"><a>5<br />1<br />1<br />4</a></td>
                    <td id="4214" rowspan=2 class="navette_shut"><a>4<br />2<br />1<br />4</a></td>
                    <td id="" class="invisible_td"><a>0<br /></a></td>
                    <td id="4114" rowspan=2 class="navette_shut"><a>4<br />1<br />1<br />4</a></td>
                    <td id="3214" rowspan=2 class="navette_shut"><a>3<br />2<br />1<br />4</a></td>
                    <td id="" class="invisible_td"><a>0<br /></a></td>
                    <td id="3114" rowspan=2 class="navette_shut"><a>3<br />1<br />1<br />4</a></td>
                    <td id="2214" rowspan=2 class="navette_shut"><a>2<br />2<br />1<br />4</a></td>
                    <td id="" class="invisible_td"><a>0<br /></a></td>
                    <td id="2114" rowspan=2 class="navette_shut"><a>2<br />1<br />1<br />4</a></td>
                    <td id="1214" rowspan=2 class="navette_shut"><a>1<br />2<br />1<br />4</a></td>
                    <td id="" class="invisible_td"><a>0<br /></a></td>
                    <td id="1114" rowspan=2 class="navette_shut"><a>1<br />1<br />1<br />4</a></td>
                </tr>
                <tr>
                    <td></td>
                </tr>
                <tr>
                    <td id="6213" rowspan=2 class="navette_shut"><a>6<br />2<br />1<br />3</a></td>
                    <td id="" class="invisible_td"><a>0<br /></a></td>
                    <td id="6113" rowspan=2 class="navette_shut"><a>6<br />1<br />1<br />3</a></td>
                    <td id="5213" rowspan=2 class="navette_shut"><a>5<br />2<br />1<br />3</a></td>
                    <td id="" class="invisible_td"><a>0<br /></a></td>
                    <td id="5113" rowspan=2 class="navette_shut"><a>5<br />1<br />1<br />3</a></td>
                    <td id="4213" rowspan=2 class="navette_shut"><a>4<br />2<br />1<br />3</a></td>
                    <td id="" class="invisible_td"><a>0<br /></a></td>
                    <td id="4113" rowspan=2 class="navette_shut"><a>4<br />1<br />1<br />3</a></td>
                    <td id="3213" rowspan=2 class="navette_shut"><a>3<br />2<br />1<br />3</a></td>
                    <td id="" class="invisible_td"><a>0<br /></a></td>
                    <td id="3113" rowspan=2 class="navette_shut"><a>3<br />1<br />1<br />3</a></td>
                    <td id="2213" rowspan=2 class="navette_shut"><a>2<br />2<br />1<br />3</a></td>
                    <td id="" class="invisible_td"><a>0<br /></a></td>
                    <td id="2113" rowspan=2 class="navette_shut"><a>2<br />1<br />1<br />3</a></td>
                    <td id="1213" rowspan=2 class="navette_shut"><a>1<br />2<br />1<br />3</a></td>
                    <td id="" class="invisible_td"><a>0<br /></a></td>
                    <td id="1113" rowspan=2 class="navette_shut"><a>1<br />1<br />1<br />3</a></td>
                </tr>
                <tr>
                    <td></td>
                </tr>
                <tr>
                    <td id="6212" rowspan=2 class="navette_shut"><a>6<br />2<br />1<br />2</a></td>
                    <td id="" class="invisible_td"><a>0<br /></a></td>
                    <td id="6112" rowspan=2 class="navette_shut"><a>6<br />1<br />1<br />2</a></td>
                    <td id="5212" rowspan=2 class="navette_shut"><a>5<br />2<br />1<br />2</a></td>
                    <td id="" class="invisible_td"><a>0<br /></a></td>
                    <td id="5112" rowspan=2 class="navette_shut"><a>5<br />1<br />1<br />2</a></td>
                    <td id="4212" rowspan=2 class="navette_shut"><a>4<br />2<br />1<br />2</a></td>
                    <td id="" class="invisible_td"><a>0<br /></a></td>
                    <td id="4112" rowspan=2 class="navette_shut"><a>4<br />1<br />1<br />2</a></td>
                    <td id="3212" rowspan=2 class="navette_shut"><a>3<br />2<br />1<br />2</a></td>
                    <td id="" class="invisible_td"><a>0<br /></a></td>
                    <td id="3112" rowspan=2 class="navette_shut"><a>3<br />1<br />1<br />2</a></td>
                    <td id="2212" rowspan=2 class="navette_shut"><a>2<br />2<br />1<br />2</a></td>
                    <td id="" class="invisible_td"><a>0<br /></a></td>
                    <td id="2112" rowspan=2 class="navette_shut"><a>2<br />1<br />1<br />2</a></td>
                    <td id="1212" rowspan=2 class="navette_shut"><a>1<br />2<br />1<br />2</a></td>
                    <td id="" class="invisible_td"><a>0<br /></a></td>
                    <td id="1112" rowspan=2 class="navette_shut"><a>1<br />1<br />1<br />2</a></td>
                </tr>
                <td></td>
                </tr>
                <tr>
                    <td id="6211" rowspan=2 class="navette_shut"><a>6<br />2<br />1<br />1</a></td>
                    <td id="" class="invisible_td"><a>0<br /></a></td>
                    <td id="6111" rowspan=2 class="navette_shut"><a>6<br />1<br />1<br />1</a></td>
                    <td id="5211" rowspan=2 class="navette_shut"><a>5<br />2<br />1<br />1</a></td>
                    <td id="" class="invisible_td"><a>0<br /></a></td>
                    <td id="5111" rowspan=2 class="navette_shut"><a>5<br />1<br />1<br />1</a></td>
                    <td id="4211" rowspan=2 class="navette_shut"><a>4<br />2<br />1<br />1</a></td>
                    <td id="" class="invisible_td"><a>0<br /></a></td>
                    <td id="4111" rowspan=2 class="navette_shut"><a>4<br />1<br />1<br />1</a></td>
                    <td id="3211" rowspan=2 class="navette_shut"><a>3<br />2<br />1<br />1</a></td>
                    <td id="" class="invisible_td"><a>0<br /></a></td>
                    <td id="3111" rowspan=2 class="navette_shut"><a>3<br />1<br />1<br />1</a></td>
                    <td id="2211" rowspan=2 class="navette_shut"><a>2<br />2<br />1<br />1</a></td>
                    <td id="" class="invisible_td"><a>0<br /></a></td>
                    <td id="2111" rowspan=2 class="navette_shut"><a>2<br />1<br />1<br />1</a></td>
                    <td id="1211" rowspan=2 class="navette_shut"><a>1<br />2<br />1<br />1</a></td>
                    <td id="" class="invisible_td"><a>0<br /></a></td>
                    <td id="1111" rowspan=2 class="navette_shut"><a>1<br />1<br />1<br />1</a></td>
                </tr>
            </table>
        </div>
        <div class="w3-col s4 ">
            <div class="w3-display-middle w3-panel w3-card w3-margin">
                <h4 class="w3-center">Rack Location</h4>
                <div id="graph_cont">
                    <div id="left_side">
                        <ul>
                            <li>
                                <div id="l05" class="shelf"></div>
                            <li>
                                <div id="l04" class="shelf"></div>
                            <li>
                                <div id="l03" class="shelf"></div>
                            <li>
                                <div id="l02" class="shelf"></div>
                            <li>
                                <div id="l01" class="shelf"></div>
                        </ul>
                    </div>
                    <div id="left_side">
                        <ul>
                            <li>
                                <div id="x18" class="location">X18</div>
                            <li>
                                <div id="x16" class="location">X16</div>
                            <li>
                                <div id="x14" class="location">X14</div>
                            <li>
                                <div id="x12" class="location">X12</div>
                        </ul>
                        <ul>
                            <li>
                                <div id="x17" class="location">X17</div>
                            <li>
                                <div id="x15" class="location">X15</div>
                            <li>
                                <div id="x13" class="location">X13</div>
                            <li>
                                <div id="x11" class="location">X11</div>
                        </ul>
                    </div>
                    <div id="aisle_center">
                        <ul>
                            <li>
                                <span style='font-size:3.5em;'>&#8679;</span> <br />
                                <p id="aisle">Aisle</p>
                                <span style='font-size:3.5em;'>&#8679;</span> <br />
                        </ul>
                    </div><!-- aisle center -->
                    <div id="right_side">
                        <ul>
                            <li>
                                <div id="x27" class="location">X27</div>
                            <li>
                                <div id="x25" class="location">X25</div>
                            <li>
                                <div id="x23" class="location">X23</div>
                            <li>
                                <div id="x21" class="location">X21</div>
                        </ul>
                        <ul>
                            <li>
                                <div id="x28" class="location">X28</div>
                            <li>
                                <div id="x26" class="location">X26</div>
                            <li>
                                <div id="x24" class="location">X24</div>
                            <li>
                                <div id="x22" class="location">X22</div>
                        </ul>
                    </div><!-- right side -->
                    <div id="right_side">
                        <ul>
                            <li>
                                <div id="r05" class="shelf"></div>
                            <li>
                                <div id="r04" class="shelf"></div>
                            <li>
                                <div id="r03" class="shelf"></div>
                            <li>
                                <div id="r02" class="shelf"></div>
                            <li>
                                <div id="r01" class="shelf"></div>
                        </ul>
                    </div>
                    <div>
                        <table class="w3-table-all w3-card-4 w3-margin-bottom">
                            <thead>
                                <tr class="w3-light-grey">
                                    <td>Field: </td>
                                    <td id="ftable"></td>
                                </tr>
                            </thead>
                            <tr>
                                <td>X coordinate: </td>
                                <td id="xtable"></td>
                            </tr>
                            <tr>
                                <td>Y coordinate: </td>
                                <td id="ytable"></td>
                            </tr>
                            <tr>
                                <td>Z coordinate: </td>
                                <td id="ztable"></td>
                            </tr>
                        </table>
                    </div>

                </div><!-- graph_cont -->
            </div>
        </div>
        <div class="w3-col s3 w3-center">
            <div class="w3-display-left w3-panel w3-card w3-margin">
                <h4>Single Coordinate Check:</h4>
                <input type="text" name="filename" value="" id="inputText" style="width: auto;">
                </br>
                <h4>Message:</h4>
                <input type="text" name="filename" value="" id="resultText" style="width: auto;" readonly>
                </br>
                <input type="button" class="smbutton" id="ParseButton" value="Check Coordinate" onclick="parseData()">
                </br>
                </br>
                <h4>Select Blockade Checklist File:</h4>
                <input class="file" id="file" type="file" multiple="multiple">
                </br>
                <input type="button" class="smbutton" value="Create Workbook" onclick="parsefiles()">
            </div>
        </div>
    </div>
</body>

</html>